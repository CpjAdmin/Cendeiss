function agregarFilasDT(n){for(var i=[],t=0;t<n.length;t++)i.push([n[t].cedula,n[t].nombre,n[t].aportes,n[t].rendimientos,n[t].tipo,n[t].descripcion,n[t].documento,n[t].fecha]);tabla=objTabla.DataTable({data:i,pageLength:500,lengthMenu:[[500,1e3,2e3],["500 Registros","1000 Registros","2000 Registros"]],dom:"Bfrtip",buttons:[{extend:"pageLength"},{extend:"csvHtml5",action:function(n,t,i,r){dialogoProgreso.show('Exportando archivo CSV, espere un momento<span class="glyphicon glyphicon-hourglass"><\/span>');var u=this;setTimeout(function(){$.fn.DataTable.ext.buttons.csvHtml5.action.call(u,n,t,i,r);dialogoProgreso.hide()},1e3)},title:function(){return nombreReporte+$.datepicker.formatDate("dd-mm-yy",fechaA)+" Al "+$.datepicker.formatDate("dd-mm-yy",fechaB)}},{extend:"excelHtml5",action:function(n,t,i,r){dialogoProgreso.show('Exportando archivo EXCEL, espere un momento<span class="glyphicon glyphicon-hourglass"><\/span>');var u=this;setTimeout(function(){$.fn.DataTable.ext.buttons.excelHtml5.action.call(u,n,t,i,r);dialogoProgreso.hide()},1e3)},title:function(){return nombreReporte+$.datepicker.formatDate("dd-mm-yy",fechaA)+" Al "+$.datepicker.formatDate("dd-mm-yy",fechaB)},sheetName:"Movimientos CENDEISSS"}],language:{url:"resources/components/datatables-buttons/json/spanish.json",buttons:{copyTitle:"Añadido al portapapeles",copyKeys:"Presione <i> ctrl <\/ i> o <i>  u2318 <\/ i> + <i> C <\/ i> para copiar los datos de la tabla al portapapeles. <br> <br> Para cancelar, haga clic en este mensaje o presione Esc.",copySuccess:{_:"%d lineas copiadas",1:"1 línea copiada"},pageLength:{_:"Mostrar %d Filas","-1":"Ver todo"}}},fnDrawCallback:function(){var n=objTabla.DataTable();n.data().length===0?n.buttons(".dt-button").disable():n.buttons(".dt-button").enable()},bDestroy:!0,bDeferRender:!0,paging:!0,scrollY:$(document).height()-427+"px",scrollX:!0,scrollCollapse:!0,scroller:!0,autoWidth:!1,responsive:!0,aoColumns:[{sClass:"textoCentrado"},null,{bSortable:!1,render:$.fn.dataTable.render.number(",",".",2,""),sClass:"text-right"},{bSortable:!1,render:$.fn.dataTable.render.number(",",".",2,""),sClass:"text-right"},{sClass:"center"},null,null,{sClass:"center"}]});tabla.draw()}function AjaxCargarMovimientos(n){n=JSON.stringify(n);$.ajax({type:"POST",url:"ConsultaMovimientos.aspx/CargarMovimientos",data:n,contentType:"application/json; charset=utf-8",error:function(n,t,i){MensajeAlerta="Error: "+n.status+"<br>"+n.responseJSON.Message;"\n"+i;mensajeError(MensajeAlerta,paginaURL);setTimeout(function(){window.location="./Login.aspx"},5e3);animacion!==undefined&&setTimeout(function(){dialogoProgreso.hide();dialogoProgreso.stopAnimate(animacion)},500)},success:function(n){n.d.length>0?agregarFilasDT(n.d):(MsjPersonalizado="No existen registros para el Periodo consultado!",tipoMsj="info",Alerta("mensajesAlerta",MsjPersonalizado,tipoMsj,2e3))}}).done(function(){animacion!==undefined&&setTimeout(function(){dialogoProgreso.hide();dialogoProgreso.stopAnimate(animacion)},500)})}var tabla,data,objTabla=$("#tbl_movimientos"),paginaURL="ConsultaMovimientos.aspx",inicio,MensajeAlerta,tipoMsj,tituloReporte="COOPECAJA RL - Consulta de Movimientos",nombreReporte="COOPECAJA RL - Desde ",animacion,fechaA,fechaB;$(document).ready(function(){var n=new Date("01/01/2018"),t=new Date,i=new Date;i.setDate(i.getDate()+365);$("#fechaInicial").datepicker({format:"dd-mm-yyyy",showButtonPanel:!0,orientation:"bottom",autoclose:!0,weekStart:1,startDate:"01/01/2018",endDate:t}).on("changeDate",function(t){var r=$("#txtUsuario").val();n=new Date(t.date.valueOf());n.setDate(n.getDate(new Date(t.date.valueOf())));$("#fechaFinal").datepicker("setStartDate",n);$("#txtUsuario").prop("readonly",!0);r===""&&($("#txtUsuario").prop("placeholder","Todos"),i=new Date(n.getFullYear(),n.getMonth()+1,0),$("#fechaFinal").datepicker("setEndDate",i))});$("#fechaFinal").datepicker({weekStart:1,format:"dd-mm-yyyy",showButtonPanel:!0,orientation:"bottom",autoclose:!0,startDate:n,endDate:i}).on("changeDate",function(i){var r=$("#txtUsuario").val();t=new Date(i.date.valueOf());t.setDate(t.getDate(new Date(i.date.valueOf())));$("#fechaInicial").datepicker("setEndDate",t);r===""&&(n=new Date(t.getFullYear(),t.getMonth(),1),$("#fechaInicial").datepicker("setStartDate",n))})});$("#txtUsuario").on("input",function(){this.value=this.value.replace(/[^0-9]/g,"")});$(document).on("click","#btnEjecutarConsulta",function(n){var i,t;n.preventDefault();$("#fechaInicial").val()===""?$("#fechaInicial").focus():$("#fechaFinal").val()===""?$("#fechaFinal").focus():(i=$("#txtUsuario").length?$("#txtUsuario").val():login,i===""&&($("#txtUsuario").focus(),dialogoProgreso.show('Cargando <span class="glyphicon glyphicon-hourglass"><\/span>'),animacion=dialogoProgreso.animate()),fechaA=$("#fechaInicial").datepicker("getDate"),fechaB=$("#fechaFinal").datepicker("getDate"),t={},t.usuario=i,t.f_ini=fechaA,t.f_fin=fechaB,t.id=login,AjaxCargarMovimientos(t))});$(document).on("click","#btnLimpiar",function(n){if(n.preventDefault(),$(".dt-button").length){var t=objTabla.DataTable().rows().count();t>0?objTabla.dataTable().fnClearTable():(MsjPersonalizado="La tabla de datos está vacia!",tipoMsj="warning",Alerta("mensajesAlerta",MsjPersonalizado,tipoMsj,2e3))}else MsjPersonalizado="La tabla de datos está vacia!",tipoMsj="warning",Alerta("mensajesAlerta",MsjPersonalizado,tipoMsj,2e3)});