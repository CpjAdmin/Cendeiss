function llenarDataModalCambioClave(){var n="",t="";sistema==="CENDEISSS"&&(t="usuario.png",n="<strong>CAMBIO DE CONTRASEÑA <\/strong><ul class='nav navbar-nav'><li class='dropdown user user-menu'><img src='resources/v0001/img/"+t+"' class='user-image'><\/li><\/ul>");$("#modalTituloCambiarClave").html(n);$("#ModalTxtClave1").focus();verificarClaves()}function verificarClaves(){function r(){var r=i.val(),s=t.val();n.show().removeClass("negacion confirmacion");r!==s&&(n.text(f).addClass("negacion"),clavesIguales=!1);(r.length===0||r==="")&&(n.text(o).addClass("negacion"),clavesIguales=!1);r.length<6&&(n.text(e).addClass("negacion"),clavesIguales=!1);r.length!==0&&r.length>=6&&r===s&&(n.text(u).removeClass("negacion").addClass("confirmacion"),clavesIguales=!0)}var i=$("#ModalTxtClave1"),t=$("#ModalTxtClave2"),u="Contraseñas SI coinciden",f="Contraseñas NO coinciden",e="Longitud mínima, 6 carácteres.",o="Contraseña NO puede estar vacía",n;$("#spanError").length>0?$("#spanError").hide():n=$('<span class="spanError" id="spanError"><\/span>').insertAfter(t);t.keyup(function(){r()});i.keyup(function(){t.val().length>=6&&r()})}function cerrarModalClave(){modalCambiarClave.modal("hide")}function actualizarClaveAjax(n){var t=JSON.stringify({clave:$("#ModalTxtClave1").val(),sistema:n,id:login});$.ajax({type:"POST",url:paginaURL+"/ActualizarClave",data:t,dataType:"json",contentType:"application/json; charset=utf-8",error:function(n,t,i){MensajeAlerta=n.status+"\n"+n.responseText;"\n"+i;mensajeError(MensajeAlerta,"Inicio.aspx")},success:function(t){t.d?(MensajeAlerta="Contraseña de <strong> "+n+" <\/strong> actualizada correctamente!",Alerta("mensajesAlerta",MensajeAlerta,"success",3e3)):(MensajeAlerta="Contraseña de <strong> "+n+" <\/strong>  no se actualizó!",Alerta("mensajesAlerta",MensajeAlerta,"danger",3e3))}})}function CargarCantones(){if($("#ddlCanton").attr("disabled","disabled"),$("#ddlDistrito").empty().append('<option selected="selected" value="">Seleccione un valor<\/option>'),$("#ddlDistrito").attr("disabled","disabled"),$("#ddlProvincia").val()==="")$("#ddlCanton").empty().append('<option selected="selected" value="">Seleccione un valor<\/option>'),$("#ddlDistrito").empty().append('<option selected="selected" value="">Seleccione un valor<\/option>');else{$("#ddlCanton").empty().append('<option selected="selected" value="">Cargando...<\/option>');var n={};n.provinciaId=$("#ddlProvincia").val();n=JSON.stringify(n);$.ajax({type:"POST",url:paginaURL+"/CargarCantones",data:n,contentType:"application/json; charset=utf-8",dataType:"json",success:IniciarCargaCantones,error:function(n,t,i){MensajeAlerta=n.status+"\n"+n.responseText;"\n"+i;mensajeError(MensajeAlerta,paginaURL)}})}}function IniciarCargaCantones(n){LlenarControl(n.d,$("#ddlCanton"))}function CargarDistritos(){if($("#ddlCanton").val()==="")$("#ddlDistrito").empty().append('<option selected="selected" value="">Seleccione un valor<\/option>');else{$("#ddlDistrito").empty().append('<option selected="selected" value="">Cargando...<\/option>');var n={};n.provinciaId=$("#ddlProvincia").val();n.cantonId=$("#ddlCanton").val();n=JSON.stringify(n);$.ajax({type:"POST",url:paginaURL+"/CargarDistritos",data:n,contentType:"application/json; charset=utf-8",dataType:"json",success:IniciarCargaDistritos,error:function(n,t,i){MensajeAlerta=n.status+"\n"+n.responseText;"\n"+i;mensajeError(MensajeAlerta,paginaURL)}})}}function IniciarCargaDistritos(n){LlenarControl(n.d,$("#ddlDistrito"))}function LlenarControl(n,t){n.length>0?(t.removeAttr("disabled"),t.empty().append('<option selected="selected" value="">Seleccione un valor<\/option>'),t.attr("id")==="ddlCanton"?$.each(n,function(){t.append($("<option><\/option>").val(this.cod_canton).html(this.nombre))}):t.attr("id")==="ddlDistrito"&&$.each(n,function(){t.append($("<option><\/option>").val(this.cod_distrito).html(this.nombre))})):t.empty().append('<option selected="selected" value="">No existen registros!<option>')}function ProcesarPerfil(){var n={},t;n.p_id=$("#Id").val();n.p_nombre=$("#txtNombre").val();n.p_email=$("#txtCorreoPrin").val();n.p_email2=$("#txtCorreoSec").val();n.p_tel_habitacion=$("#txtTelHabitacion").val();n.p_tel_celular=$("#txtTelCelular").val();n.p_tel_trabajo=$("#txtTelTrabajo").val();n.p_direccion=$("#txtOtrasS").val();var i=$("#ddlProvincia").val()===""?"008":$("#ddlProvincia").val(),r=$("#ddlCanton").val()===""?"":$("#ddlCanton").val(),u=$("#ddlDistrito").val()===""?"":$("#ddlDistrito").val();n.p_ubicacion_geografica=i+r+u;n.p_f_nacimiento=$("#fechaNacimiento").val();t=JSON.stringify(n);$.ajax({type:"POST",url:paginaURL+"/ProcesarUsuario",data:t,dataType:"json",contentType:"application/json; charset=utf-8",error:function(n,t,i){MensajeAlerta="Error: "+n.status+"<br>"+n.responseJSON.Message;"\n"+i;mensajeError(MensajeAlerta,paginaURL);setTimeout(function(){window.location="./Login.aspx"},4e3)},success:function(n){n.d?(MensajeAlerta="Perfil actualizado correctamente.",Alerta("mensajesAlerta",MensajeAlerta,"success",3e3),setTimeout(function(){window.location="./Inicio.aspx"},4e3)):(MensajeAlerta="No se pudo actualizar el perfil.",Alerta("mensajesAlerta",MensajeAlerta,"danger",3e3))}})}var tabla,data,paginaURL="MantenimientoPerfil.aspx",height,inicio,MensajeAlerta,tipoMsj;$(document).ready(function(){$("#txtId").prop("disabled",!0);$("#txtPerfilRol").prop("disabled",!0);$(":input").inputmask();$("#fechaNacimiento").datepicker({format:"yyyy-mm-dd",showButtonPanel:!0,orientation:"bottom",autoclose:!0,weekStart:1,startDate:"1900/01/01"});$("#btnCambiarClave").click(function(n){n.preventDefault();sistema=$(this).attr("name");llenarDataModalCambioClave()});$("#btnModalClaveActualizar").click(function(n){n.preventDefault();clavesIguales&&(actualizarClaveAjax(sistema),cerrarModalClave())});$("#btnModalClaveCancelar").click(function(n){n.preventDefault();cerrarModalClave()});modalCambiarClave.on("hidden.bs.modal",function(){$("#spanError").remove();modalCambiarClave.find("input[type='password']").val("")});modalCambiarClave.on("shown.bs.modal",function(){$("#ModalTxtClave1").focus()})});$(document).on("click","#btnGuardarPerfil",function(n){if($("#txtNombre")[0].checkValidity())if($("#txtCorreoPrin")[0].checkValidity())if($("#txtCorreoSec")[0].checkValidity())if($("#txtTelHabitacion")[0].checkValidity())if($("#txtTelCelular")[0].checkValidity())if($("#txtTelTrabajo")[0].checkValidity())if($("#fechaNacimiento")[0].checkValidity())if($("#ddlProvincia")[0].checkValidity())if($("#ddlCanton")[0].checkValidity())if($("#ddlDistrito")[0].checkValidity())n.preventDefault(),ProcesarPerfil();else return!0;else return!0;else return!0;else return!0;else return!0;else return!0;else return!0;else return!0;else return!0;else return!0});